{% extends "daintree/base.html" %}
{% load staticfiles %}

{% block content %}
<h2>Search</h2>
<div class="form">
    <form action="" method="get" class="form-search">
        {{ form.as_p }}
        <input type="submit" value="Search" class="submit">
    </form>
</div>
{% if aggregations.categories.buckets %}
<h2>Categories</h2>
<ul>
    {% for bucket in aggregations.categories.buckets %}
        <li>{{ bucket.key }} ({{ bucket.doc_count }})</li>
    {% endfor %}
</ul>
{% endif %}
<ul>
    {% if products %}
        {% for product in products %}
        <li>
            Name: <b>{{ product.name }}</b><br>
            <i>Category: {{ product.category }}</i><br>
            <i>Price: {{ product.price }}</i><br>
            {% if product.tag.all %}
                Tags: (
                {% for tag in product.tags.all %}
                    {{ tag.name }}
                    {% if not forloop.last %}
                    ,
                    {% endif %}
                {% endfor %}
                )
            {% endif %}
        </li>
        {% endfor %}
    {% else %}
       <p>No result found. Please try another search term.</p>
    {% endif %}
</ul>
{% endblock %}